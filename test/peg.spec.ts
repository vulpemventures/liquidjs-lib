import { strictEqual } from 'assert';

import { describe, it } from 'mocha';
import { Transaction } from '../ts_src';

describe('Claim transaction (peg-in)', () => {
  it('should compute the right transaction id (tx hash)', () => {
    const claimTxHex =
      '020000000101b07d851f6db5d23fe9bf649363a3118d2f7d682df8d0f2e8c3a26f76a4a23d730100004000ffffffff0201185b935df5270fd300fbf9ae612de0d551030363ceb71bd6f2161568ee93620501000000000bebc1000016001442acdb02844ac41e6b4359f52412769731bac8be01185b935df5270fd300fbf9ae612de0d551030363ceb71bd6f2161568ee9362050100000000000001000000000000000000024730440220583f4d77440f15501eb944ac7dcd5974747360df9e5b43b546f6a988145e575802200bce3580356ea2f04f496d76514505db61ef650b4115452bd74dad9c38f992f4012102ac530af3b8705d0063083a82ec5b1cad96ff99d02ba6bb3b98ebcd1dc1eac011060800c2eb0b0000000020185b935df5270fd300fbf9ae612de0d551030363ceb71bd6f2161568ee9362052006226e46111a0b59caaf126043eb5bbf28c34f3a5e332a1fc7b2b73cf188910f16001442acdb02844ac41e6b4359f52412769731bac8be720200000001c4248c00fcdb22d849d76588d097013bfb55e7f5497db657485fa7af7e7501c20100000000feffffff02e4647fe20000000016001483a5de09980fd0df0afbc17c67988b3633868d7d00c2eb0b0000000017a914996e134469a6bad410e16d29b1f762b04e2dbcaf8767000000970000002070fd3a37a41c3d7ceed7005a1a7d4731ff77761de69f387a8be547f8f865f36e90a1a32b46e465d27dbe8c8f67b5e49f8383a0e393a3a83c47ac83ffef939b742a3d1e61ffff7f2000000000020000000296d871740066998a0a16044d411b154410f7bea55b18e685e51c68b6630141dbb07d851f6db5d23fe9bf649363a3118d2f7d682df8d0f2e8c3a26f76a4a23d73010500000000';
    const expectedTxID =
      'f4b25e1c71b93c901075f1477477620dcc8c88218a607529c178a4a69360585a'; // computed with go-elements

    const claimTx = Transaction.fromHex(claimTxHex);
    strictEqual(claimTx.getId(), expectedTxID);
  });
});
